import{o as I,q as N,c as u,a as t,f as p,t as n,e as h,F as S,r as V,p as y,i,s as L,l as x,x as M}from"./index-D6lzrY5p.js";const T={class:"min-h-screen bg-slate-50 p-6 font-sans"},P={class:"mb-10 flex items-center justify-between"},W={class:"flex items-center gap-6"},q={class:"grid grid-cols-1 md:grid-cols-4 gap-8 mb-10"},z={class:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100 flex flex-col justify-between"},J={class:"text-5xl font-extrabold text-slate-800"},O={class:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100 flex flex-col justify-between"},R={class:"text-5xl font-extrabold text-red-600"},U={class:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100 flex flex-col justify-between"},G={class:"text-5xl font-extrabold text-blue-600"},H={class:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100 flex flex-col justify-between bg-gradient-to-br from-indigo-500 to-purple-600 text-white"},K={class:"font-mono font-bold tracking-wider text-2xl"},Q={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-10"},X={class:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100"},Y={key:0,class:"mt-8 space-y-4"},Z={class:"flex justify-between text-base"},tt={class:"font-bold text-slate-700 text-lg"},et={class:"flex justify-between text-base"},st={class:"font-bold text-slate-700 text-lg"},lt={class:"flex justify-between text-base"},ot={class:"font-bold text-red-600 text-lg"},at={class:"bg-white p-8 rounded-3xl shadow-sm border border-slate-100"},nt={class:"overflow-x-auto"},rt={class:"w-full text-base text-left text-slate-500"},dt={class:"px-8 py-6 font-medium"},it={class:"px-8 py-6"},ut={class:"flex flex-col"},xt={class:"font-bold text-slate-900 text-lg"},ct={class:"text-sm text-slate-400 font-mono"},pt=["title"],bt={class:"px-8 py-6"},ft={class:"px-8 py-6"},mt={key:0,class:"bg-red-100 text-red-800 text-sm font-bold px-4 py-1.5 rounded-full"},gt={key:1,class:"bg-orange-100 text-orange-800 text-sm font-bold px-4 py-1.5 rounded-full"},vt={class:"px-8 py-6"},ht=["onClick"],yt={key:0},Ct={__name:"DashboardView",setup(wt){const r=i([]),b=i([]),w=i([]),_=i(0),k=i(0),d=i("ì´ˆê¸°í™” ì¤‘..."),f=i(!1),c=i(null),C=i(""),m=L(()=>{if(!r.value||!Array.isArray(r.value))return{labels:["ì•ˆì •","ì£¼ì˜","ìœ„í—˜"],datasets:[{data:[0,0,0],backgroundColor:["#10B981","#FBBF24","#EF4444"],borderWidth:0}]};const s=r.value.filter(o=>(o.mood_score||0)<=2).length,e=r.value.filter(o=>(o.mood_score||0)===3||(o.mood_score||0)===4).length,l=r.value.filter(o=>(o.mood_score||0)>=5).length;return{labels:["ì•ˆì •","ì£¼ì˜","ìœ„í—˜"],datasets:[{data:[l,e,s],backgroundColor:["#10B981","#FBBF24","#EF4444"],borderWidth:0}]}}),D=async()=>{f.value=!0,d.value="ë°ì´í„° ë¡œë”© ì‹œì‘...";try{d.value+=`
1. í™˜ì ëª©ë¡ í˜¸ì¶œ ì¤‘...`;const s=await y.get("diaries/staff/patients/");d.value+=`
   - ì„±ê³µ: ${s.data.length}ëª… ìˆ˜ì‹ `,w.value=s.data||[],_.value=w.value.length,d.value+=`
2. ì¼ê¸° ëª©ë¡ í˜¸ì¶œ ì¤‘...`;const e=await y.get("diaries/staff/diaries/"),l=e.data.results||e.data;d.value+=`
   - ì„±ê³µ: ${Array.isArray(l)?l.length:"ë°°ì—´ì•„ë‹˜"}ê±´ ìˆ˜ì‹ `,r.value=Array.isArray(l)?l:[],r.value=r.value.filter(o=>o&&o.created_at),b.value=r.value.filter(o=>(o.mood_score||0)<=2).sort((o,g)=>new Date(g.created_at)-new Date(o.created_at)).slice(0,10),k.value=r.value.length,d.value+=`
âœ… ëª¨ë“  ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ`}catch(s){console.error("ëŒ€ì‹œë³´ë“œ ì—ëŸ¬:",s),d.value+=`
âŒ ì—ëŸ¬ ë°œìƒ: ${s.message}`,s.response&&(d.value+=`
   - Status: ${s.response.status}`,d.value+=`
   - Data: ${JSON.stringify(s.response.data).slice(0,50)}...`),r.value=[],b.value=[]}finally{f.value=!1}},F=async()=>{var s,e;f.value=!0,C.value="",c.value=null;try{const l=await y.post("centers/generate/");c.value=l.data.code,j()}catch(l){console.error(l),C.value="ì½”ë“œ ìƒì„± ì‹¤íŒ¨: "+(((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.error)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")}finally{f.value=!1}},j=()=>{if(!c.value)return;const s=c.value;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(s).then(()=>alert("ì¸ì¦ ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")).catch(()=>$(s)):$(s)},$=s=>{const e=document.createElement("textarea");e.value=s,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")?alert("ì¸ì¦ ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤."):prompt("ìë™ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”:",s)}catch{prompt("ìë™ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”:",s)}document.body.removeChild(e)},E=s=>s?new Date(s).toLocaleString():"-";let v=null;return I(()=>{D(),v=setInterval(D,5e3)}),N(()=>{v&&clearInterval(v)}),(s,e)=>{var l,o,g;return x(),u("div",T,[t("header",P,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-4xl font-extrabold text-slate-900 tracking-tight"},"InsightMind Dashboard"),t("p",{class:"text-xl text-slate-500 font-medium mt-2"},"ë„ë´‰êµ¬ ì •ì‹ ê±´ê°•ë³µì§€ì„¼í„° í†µí•© ê´€ì œ ì‹œìŠ¤í…œ")],-1)),t("div",W,[t("button",{onClick:e[0]||(e[0]=a=>s.$router.push("/admin/patients")),class:"bg-white border border-slate-300 text-slate-700 font-bold py-3 px-6 rounded-xl hover:bg-slate-50 transition flex items-center gap-3 text-lg"},[...e[1]||(e[1]=[t("span",null,"ğŸ‘¥ ì „ì²´ í™˜ì ê´€ë¦¬",-1)])]),e[2]||(e[2]=t("div",{class:"bg-white px-6 py-3 rounded-xl shadow-sm border border-slate-200 text-base"},[t("span",{class:"text-slate-500"},"ë‹´ë‹¹ì:"),t("span",{class:"font-bold text-slate-800 ml-2 text-lg"},"ê´€ë¦¬ì(Admin)")],-1))])]),t("div",q,[t("div",z,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-lg font-bold text-slate-500 mb-2"},"ì´ ë“±ë¡ ëŒ€ìƒì",-1)),t("h3",J,[p(n(_.value),1),e[4]||(e[4]=t("span",{class:"text-xl font-normal text-slate-400 ml-2"},"ëª…",-1))])]),e[6]||(e[6]=t("div",{class:"mt-6 flex items-center text-sm font-medium text-green-600 bg-green-50 w-fit px-3 py-1.5 rounded-lg"},[t("span",null,"ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ë¨")],-1))]),t("div",O,[t("div",null,[e[8]||(e[8]=t("p",{class:"text-lg font-bold text-slate-500 mb-2"},"ê³ ìœ„í—˜êµ° ì§‘ì¤‘ ê´€ë¦¬",-1)),t("h3",R,[p(n(b.value.length),1),e[7]||(e[7]=t("span",{class:"text-xl font-normal text-slate-400 ml-2"},"ê±´",-1))])]),e[9]||(e[9]=t("div",{class:"mt-6 flex items-center text-sm font-medium text-red-600 bg-red-50 w-fit px-3 py-1.5 rounded-lg"},[t("span",null,"âš ï¸ ìµœê·¼ ê°ì§€ (10ê±´)")],-1))]),t("div",U,[t("div",null,[e[11]||(e[11]=t("p",{class:"text-lg font-bold text-slate-500 mb-2"},"ëˆ„ì  ì¼ê¸° ë°ì´í„°",-1)),t("h3",G,[p(n(k.value),1),e[10]||(e[10]=t("span",{class:"text-xl font-normal text-slate-400 ml-2"},"ê±´",-1))])]),e[12]||(e[12]=t("div",{class:"mt-6 flex items-center text-sm font-medium text-slate-500"},[t("span",null,"ì „ì²´ ê¸°ê°„ í•©ê³„")],-1))]),t("div",H,[t("div",null,[e[14]||(e[14]=t("p",{class:"text-lg font-bold text-indigo-100 mb-2"},"ì‹ ê·œ ì—°ë™ ì½”ë“œ ë°œê¸‰",-1)),t("button",{onClick:F,class:"mt-4 w-full bg-white/20 hover:bg-white/30 text-white font-bold py-3 px-6 rounded-xl transition text-base flex items-center justify-center gap-2"},[...e[13]||(e[13]=[t("span",null,"ğŸ”‘ ì½”ë“œ ìƒì„±í•˜ê¸°",-1)])])]),c.value?(x(),u("div",{key:0,class:"mt-4 bg-white text-indigo-900 p-3 rounded-xl text-center relative group cursor-pointer",onClick:j},[t("span",K,n(c.value),1),e[15]||(e[15]=t("div",{class:"absolute inset-0 bg-black/10 opacity-0 group-hover:opacity-100 flex items-center justify-center rounded-xl transition"},[t("span",{class:"text-xs font-bold"},"ë³µì‚¬í•˜ê¸°")],-1))])):h("",!0)])]),t("div",Q,[e[20]||(e[20]=t("div",{class:"col-span-2 bg-white p-8 rounded-3xl shadow-sm border border-slate-100"},[t("h3",{class:"text-2xl font-bold text-slate-800 mb-8"},"ğŸ“‰ ì „ì²´ ëŒ€ìƒì í‰ê·  ê¸°ë¶„ ë³€í™” (ì£¼ê°„)"),t("div",{class:"h-80"},[t("p",{class:"text-center text-slate-400 py-10"},"ì°¨íŠ¸ ë¡œë”© ì¤‘ë‹¨ (ìœ ì§€ë³´ìˆ˜ ì¤‘)")])],-1)),t("div",X,[e[19]||(e[19]=t("h3",{class:"text-2xl font-bold text-slate-800 mb-8"},"ğŸš¨ ê°ì • ìƒíƒœ ë¶„í¬ (ì „ì²´)",-1)),(g=(o=(l=m.value)==null?void 0:l.datasets)==null?void 0:o[0])!=null&&g.data?(x(),u("div",Y,[t("div",Z,[e[16]||(e[16]=t("span",{class:"flex items-center"},[t("span",{class:"w-3 h-3 rounded-full bg-green-500 mr-3"}),p("ì•ˆì • (5ì  ì´ìƒ)")],-1)),t("span",tt,n(m.value.datasets[0].data[0]||0)+"ê±´",1)]),t("div",et,[e[17]||(e[17]=t("span",{class:"flex items-center"},[t("span",{class:"w-3 h-3 rounded-full bg-yellow-400 mr-3"}),p("ì£¼ì˜ (3-4ì )")],-1)),t("span",st,n(m.value.datasets[0].data[1]||0)+"ê±´",1)]),t("div",lt,[e[18]||(e[18]=t("span",{class:"flex items-center"},[t("span",{class:"w-3 h-3 rounded-full bg-red-500 mr-3"}),p("ìœ„í—˜ (2ì  ì´í•˜)")],-1)),t("span",ot,n(m.value.datasets[0].data[2]||0)+"ê±´",1)])])):h("",!0)])]),t("div",at,[e[23]||(e[23]=t("h3",{class:"text-2xl font-bold text-slate-800 mb-6"},"ğŸ”” ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì•Œë¦¼",-1)),t("div",nt,[t("table",rt,[e[22]||(e[22]=t("thead",{class:"text-sm text-slate-700 uppercase bg-slate-50"},[t("tr",null,[t("th",{class:"px-8 py-5"},"ì‹œê°„"),t("th",{class:"px-8 py-5"},"ëŒ€ìƒì"),t("th",{class:"px-8 py-5"},"ì´ë²¤íŠ¸"),t("th",{class:"px-8 py-5"},"ê°ì • ì ìˆ˜"),t("th",{class:"px-8 py-5"},"ìƒíƒœ"),t("th",{class:"px-8 py-5"},"ì¡°ì¹˜")])],-1)),t("tbody",null,[(x(!0),u(S,null,V(b.value,a=>{var B,A;return x(),u("tr",{key:a.id,class:"bg-white border-b hover:bg-slate-50 transition"},[t("td",dt,n(E(a.created_at)),1),t("td",it,[t("div",ut,[t("span",xt,n(((B=a.user_info)==null?void 0:B.name)||"ì‹¤ëª…ì—†ìŒ"),1),t("span",ct,"("+n(((A=a.user_info)==null?void 0:A.username)||a.user)+")",1)])]),t("td",{class:"px-8 py-6 text-red-600 hover:text-red-800 cursor-pointer font-medium",title:a.content||""},n((a.content||"").length>25?(a.content||"").slice(0,25)+"...":a.content||"-"),9,pt),t("td",bt,[t("span",{class:M(["font-extrabold text-xl",a.mood_score<=2?"text-red-500":"text-slate-700"])},n(a.mood_score)+"ì  ",3)]),t("td",ft,[a.mood_score<=2?(x(),u("span",mt,"ê³ ìœ„í—˜")):(x(),u("span",gt,"ì£¼ì˜"))]),t("td",vt,[t("button",{onClick:_t=>s.$router.push(`/admin/patients/${a.user}`),class:"text-blue-600 hover:text-blue-900 font-bold text-lg border border-blue-200 bg-blue-50 px-4 py-2 rounded-lg hover:bg-blue-100 transition"}," ìƒì„¸ë³´ê¸° ",8,ht)])])}),128)),b.value.length===0?(x(),u("tr",yt,[...e[21]||(e[21]=[t("td",{colspan:"6",class:"px-6 py-8 text-center text-slate-400"}," í˜„ì¬ ê°ì§€ëœ ìœ„í—˜ ì§•í›„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ",-1)])])):h("",!0)])])])])])}}};export{Ct as default};
