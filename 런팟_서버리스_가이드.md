# 🚀 RunPod 서버리스(Serverless) 도입 가이드

100명 규모의 동시 접속 서비스를 가장 **저렴하고 효율적**으로 운영하기 위한 **RunPod Serverless** 도입 가이드입니다.

---

## 1. 서버리스(Serverless) 방식이란?

기존에 서버를 24시간 켜두고 월세를 내는 방식이 아니라, **AI 분석 요청이 들어올 때만** 번개처럼 켜져서 일을 처리하고, 일이 끝나면 자동으로 꺼지는 과금 방식입니다.

### 💰 예상 비용 비교 (RTX 3090/4090급 GPU 기준)

| 운영 방식                     | 설명             | 월 예상 비용               | 비고                                |
| :---------------------------- | :--------------- | :------------------------- | :---------------------------------- |
| **기존 방식 (24시간 풀가동)** | 서버를 계속 켜둠 | 약 343,000원 ($245)        | 사용자가 없는 새벽에도 돈이 나감 😭 |
| **서버리스 (추천 ✅)**        | 쓸 때만 돈 냄    | **약 15,000원 ~ 40,000원** | 사용자가 없으면 **0원**! 👍         |

> **결론**: 동시 접속이 간헐적으로 발생하는 서비스(일기장 등)에는 **서버리스가 압도적으로 유리**합니다.

---

## 2. RunPod 설정 방법 (웹사이트)

직접 RunPod 사이트에서 설정해야 할 단계입니다.

### ① 가입 및 충전

1.  [RunPod.io](https://www.runpod.io/) 접속 및 회원가입.
2.  `Billing` 메뉴에서 최소 금액($25 정도)을 충전합니다.

### ② 템플릿 선택 및 생성

1.  좌측 메뉴의 **`Serverless`** 클릭.
2.  **`New Endpoint`** 버튼 클릭.
3.  검색창에 **`vLLM`** 또는 **`RunPod vLLM`** 입력 후 선택 (가장 빠르고 설정이 쉬움).
4.  **GPU 선택**: `RTX 3090` 또는 `RTX 4090` (가장 가성비 좋음).

### ③ 환경 변수 (Environment Variables) 설정 ⚠️ 중요

설정 화면 아래쪽의 `Environment Variables`에 다음 값을 추가해야 합니다.

| Key (키)     | Value (값)             | 설명                            |
| :----------- | :--------------------- | :------------------------------ |
| `MODEL_NAME` | `google/gemma-2-2b-it` | 사용할 AI 모델 이름             |
| `HF_TOKEN`   | `hf_xxxxxxxx...`       | 본인의 Hugging Face 토큰 (필수) |

> **참고**: Gemma 2 모델은 Hugging Face에서 사용 동의가 필요합니다. 토큰이 없다면 Hugging Face 사이트에서 발급받으세요.

### ④ 생성 완료

- 생성이 끝나면 화면에 나오는 **`Endpoint ID`** (예: `v2/x9df8...`)와 **`API Key`**를 복사해서 메모해 두세요.

---

## 3. 코드 수정 (개발 단계)

이제 파이썬 코드(`ai_brain.py`)가 내 컴퓨터(Localhost)가 아닌 RunPod 서버로 요청을 보내도록 수정해야 합니다.

### 변경 전 (현재)

```python
url = "http://localhost:11434/api/generate"  # 내 컴퓨터가 힘들어함 💦
```

### 변경 후 (목표)

```python
url = "https://api.runpod.ai/v2/{YOUR_ENDPOINT_ID}/runsync" # 슈퍼컴퓨터가 처리 ⚡️
headers = {"Authorization": "Bearer {YOUR_API_KEY}"}
payload = {
    "input": {
        "prompt": "일기 내용...",
        "model": "google/gemma-2-2b-it"
    }
}
```

---

## ✅ 요약 및 다음 단계

1.  RunPod 사이트에서 위 가이드대로 **Endpoint**를 만드세요.
2.  발급받은 **ID**와 **API Key**를 준비하세요.
3.  준비가 되면 **"코드 수정해줘"**라고 말씀해 주세요. 제가 `ai_brain.py`를 서버리스 연동형으로 바꿔드리겠습니다.
